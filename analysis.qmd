---
title: "How Toronto Achieved a Historic Decline in Bicycle Theft in 2024"
author: 
  - Tara Chakkithara
  - Sean Chua
date: today
date-format: long
format: html
number-sections: true
bibliography: references.bib
warning: false
message: false
echo: false
---

```{r}
library(tidyverse)
library(leaflet)
library(sf)
library(ggthemes)
library(ggimage)
library(waffle)
total_data <- read_csv('analysis_data.csv')
data <- total_data |>
  filter(LONG_WGS84 != 0 & LAT_WGS84 != 0)
toronto <- st_read('toronto.geojson', quiet = TRUE)
```

# Introduction

In the past decade, cycling has become a prominent mode of transportation in Toronto. By 2019, around 75 percent of households in the city owned a bicycle, and more than 40% of people reported using their bike for non-recreational purposes such as commuting to school or the office [@cityoftoronto2019cycling]. Despite being the safest city in Canada due to its low crime density [@mazloum2024ottawa], bike theft is a significant issue. Between 2010 and 2024, Torontonians faced a total financial loss of \$33,704,466 CAD from bike theft.

Although 2024 has seen the lowest number of bike thefts since 2013, as shown in @fig-trends, the recovery rate for stolen bikes remains low at 0.7 percent, making bike theft prevention a priority for cyclists. This analysis aims to serve as a preventative guide for Toronto residents and explores the following questions: Why did bike theft drastically increase in 2014? Why did bike thefts experience a historical decline in 2024? What initiatives can Toronto Public Services take to reduce bike theft even more in the future?

```{r}
#| label: fig-trends
#| fig-cap: "Bike Theft in Toronto from 2010 to 2024"
#| fig-align: left

total_data |>
  filter(OCC_YEAR > 2010) |>
  count(OCC_YEAR) |>
  ggplot(aes(x = OCC_YEAR, y = n)) +
    geom_point(color = "#6C757D", size = 2) +  
    geom_line(color = "#17a2b8", size = 1) +
    scale_x_continuous(
      breaks = seq(min(total_data$OCC_YEAR[total_data$OCC_YEAR > 2010]), 
                   max(total_data$OCC_YEAR), 
                   by = 1)) +
    labs(
      x = "Year", 
      y = "Number of Incidents",
    ) +
    theme_minimal(base_size = 12) +  
    theme(
      plot.caption = element_text(hjust = 1, size = 10, color = "#777777"),
      axis.title = element_text(size = 12, color = "#333333", family = "Georgia"),  
      axis.text = element_text(size = 10, color = "#555555", family = "Georgia"),
      axis.title.x = element_text(size = 10, margin = margin(t = 25)),
      axis.title.y = element_text(size = 10, margin = margin(r = 25)),
      panel.grid.minor = element_blank(),
      panel.grid.major = element_line(color = "#dddddd", size = 0.5),
      plot.margin = margin(15, 15, 15, 15)
    )


```

# Characteristics of Stolen Bikes

Based on data from [Toronto's Public Safety Data Portal](https://data.torontopolice.on.ca/datasets/TorontoPS::bicycle-thefts-open-data/about), we determined that Mountain and Regular Bikes are stolen most often. Stolen bikes tend to have an average speed of 21 km/h and a typical market value of around $1,000. Black bikes make up a significant majority of thefts, likely due to their inconspicuous nature, especially at night, as well as their widespread availability in the market. The majority of all bike thefts are tied to other primary offenses, where the bike is either used as a getaway vehicle or stolen opportunistically. Around 44% of thefts are standalone incidents where bike theft is the primary crime as seen in @fig-primary.

```{r}
#| label: fig-primary
#| fig-cap: "Categories of Bike Theft"
#| fig-align: left

primary <- c("THEFT OVER - BICYCLE", "THEFT OF EBIKE UNDER $5000", "THEFT UNDER - BICYCLE",
             "THEFT OF EBIKE OVER $5000")
total_data |>
  mutate(
    TYPE = case_when(
      PRIMARY_OFFENCE %in% primary ~ "Primary Offense",
      TRUE ~ "Non Primary Offense"
    )
  ) |>
  ggplot(aes(x = "", fill = TYPE)) + 
  geom_bar(width = 1, stat = "count") +
  coord_polar(theta = "y") +
  scale_fill_manual(values = c("Primary Offense" = "#003366", "Non Primary Offense" = "#FFCC00")) +
  theme_void() +
  theme(
    legend.title = element_blank()
  )
```

# Bike Theft Distribution Across Neighbourhoods

As shown in @fig-neighbourhood, the Yonge-Bay Corridor has the highest number of bike thefts in Toronto, with 2,141 recorded thefts since 2010. In contrast, the Maple Leaf area has experienced the fewest thefts, with only 8 incidents over the same period. The Yonge-Bay Corridor is characterized by a population in which 51% are adults aged 25 to 54. The largest income group in the area earns less than 10,000 CAD, accounting for 30% of the population aged 15 and over. Additionally, 98% of residents live in apartments [@yongebay2016]. In comparison, Maple Leaf has a population approximately half the size of Yonge-Bay. 46% of its residents live in single-detached homes, and 40% of the working population earns between 20,000 and 50,000 CAD [@mapleleaf2016]. According to @fig-apt, apartments are more vulnerable to bike theft than detached homes.


```{r}
data <- data |>
  select(HOOD_158, LONG_WGS84, LAT_WGS84) |>
  group_by(HOOD_158) |>
  summarise(num_thefts = n()) |>
  filter(!is.na(HOOD_158)) |>
  rename(AREA_LONG_CODE = HOOD_158)
```

```{r}
merged_data <- toronto |>
  left_join(data, by = "AREA_LONG_CODE")
```

```{r}
#| label: fig-neighbourhood
#| fig-cap: "The Distribution of Bicycle Thefts Across Toronto Neighbourhoods"
#| fig-align: left

ggplot(data = merged_data) +
  geom_sf(aes(fill = num_thefts), color = NA, size = 0.3) +
  scale_fill_viridis_c(
    option = "C",
    trans = "log",
    direction = -1,
    breaks = c(20, 50, 150, 400, 1000),
    guide = guide_colorbar(
      barheight = unit(0.2, units = "cm"),
      barwidth = unit(5, units = "cm"),
      label.position = "bottom",
      title.position = "top",
      nrow = 1,
      label.theme = element_text(size = 8, color = "#4e4d47"),
      title.theme = element_text(
        size = 10,
        color = "#4e4d47",
        face = "plain"
      ),
      ticks = FALSE
    )
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    legend.title = element_text(face = "bold", size = 12),
    legend.text = element_text(size = 10),
    legend.key.size = unit(0.7, "cm"),
    plot.title = element_text(
      face = "bold",
      size = 16,
      hjust = 0.5,
      color = "black"
    ),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = margin(10, 10, 10, 10)
  ) +
  theme(legend.position = 'bottom') +
  labs(fill = 'Number of Bike Thefts')
```

```{r}
waffle_frame <- total_data |>
  filter(OCC_YEAR > 2010) |>
  count(PREMISES_TYPE)
```

```{r}
waffle_data <- c("Apartment" = 8849, "Commercial" = 4278, "Education" = 1578, "House" = 5333, "Other" = 4473, "Transit" = 774, "Outside" = 10834)
```

```{r}
#| label: fig-apt
#| fig-cap: "The Distribution of Bicycle Thefts Across Location Types"
#| fig-align: left

total <- sum(waffle_data)
scaled_data <- round(waffle_data / total * 100)

plot <- waffle(scaled_data, rows = 10, 
               legend_pos = "right",
               colors = c("Apartment" = "#4B9CD3",  
                          "Commercial" = "#3F6F53", 
                          "Education" = "#D1A23A",  
                          "House" = "#9F7B87",       
                          "Other" = "#D64A4A",       
                          "Transit" = "#F06D4D",     
                          "Outside" = "#7E9A92"))    

plot + 
  theme_minimal() +  
  theme(
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    legend.position = "right",  
    axis.text = element_blank(),  
    axis.ticks = element_blank(), 
    plot.caption = element_text(size = 10, color = "gray50", hjust = 0.5) 
  ) + 
  labs(caption = "1 Tile Represents 391 Thefts")
```
Bike thefts occur more often near apartments, as apartments often have communal bike storage areas which might not be relatively secure compared to individual garages (which are often more secured) in detached homes. In fact, in a 2018 article, it was written that "for the first time since Toronto police began collecting data, the number of bikes stolen from apartments, condos and their private storage rooms has surpassed those stolen on the street [@aptthefts]." Such areas are also easily accessed by multiple residents and increase the chances of theft occurring. Aside from this, thieves may be able to exploit weakly secured access points in apartment buildings which may, in turn, allow them to gain access to the aforementioned shared spaces. 

\newpage

# When are Bike Thefts most Prevalent?
The data shows that bike thefts are more often in urbanized and dense areas where there is both an abundance of bikers and foot traffic. With increased foot traffic, thieves are more easily able to blend in with their surroundings compared to isolated areas; moreover, the sheer number of bikes in urban areas naturally leads to more instances of thefts in general. 

```{r}
total_data |>
  ggplot(aes(x = OCC_HOUR)) +
  geom_density(
    fill = "#4C9F70",       
    color = "#2A5D3D",      
    size = 1,               
    adjust = 1.5,          
    alpha = 0.6             
  ) +
  labs(
    subtitle = "Distribution of Bike Thefts across Different Hours",  
    x = "Hour of Day", 
    y = "Density",  
  ) +
  theme_minimal(base_size = 14) + 
  theme(
    plot.subtitle = element_text(size = 14, hjust = 0.5, color = "gray"),
    axis.title = element_text(size = 16),  
    axis.text = element_text(size = 12, color = "black"),  
    axis.ticks = element_line(color = "gray"), 
    panel.grid.major = element_line(color = "lightgray", linetype = "dotted"),  
    panel.grid.minor = element_blank(), 
    plot.caption = element_text(size = 12, color = "gray", hjust = 1)
  )

```
This being said, from the above figure, we can see that the number of thefts reaches its peak at around 7:00pm. This may be attributed to nighttime hours where there relatively less visibility as well as a more crowded environments, as more people tend to go out during this time. Another factor contributing to this would be the fact that many commuters tend to return from work during this time, leading to a higher volume of parked bikes on streets and other public areas.

# Prevention is Better than Cure: Report Time and Recovery Chances
According to the data, it is almost certain that a stolen bike actually remains stolen. More than 97% of reportedly stolen bikes have never been recovered since 2011. It is well-known that the longer one goes without reporting a theft, the higher chance of the item not being recovered; as such, it is vital for one to exercise great caution with taking care of bikes and prevent them from ever being stolen in the first place. Some solutions include using locks with more robust locking mechanisms to prevent easy breakage and access to parked bikes. One can also opt to secure both the frame and at least one wheel to a fixed object to reduce the chances of the entire bike getting stolen.

# Conclusion
Toronto has experienced a relatively high amount of bike thefts over the past decade. Due to the nature of this crime, it remains to be a prevalent issue that is typically concentrated in high-density areas, especially in locations with high bicycle ownership. The majority of these are committed by opportunistic thieves who exploit vulnerabilities in bikes, such as unattended bikes secured with weak locks, and generally reside in urban areas. They are also often driven by financial needs or drug dependencies in some cases. Some thieves specifically target bikes in whole or in part â€” either to sell parts or the entire bike in exchange for the aforementioned incentives. The detection and recovery rates for stolen bikes are typically extremely low; this could partly be attributed to victims being unable to provide sufficient information or evidence about the theft or the thief. 

# References
